import std/bitops

func `or`[A, B](a: A, b: B): int = a.int or b.int
func `and`[A, B](a: A, b: B): int = a.int and b.int

template fromId(id, cat: untyped): untyped = bitor(id.int, cat.int)
# template fromTok(tok: )
# template fromId(id, cat: untyped): untyped = id  or  cat

# #define ID_FROM_TOKEN(tok)       ((tok) & ~TokenTypeMask)
# #define BASEID_FROM_TOKEN(tok)   ((tok) & ~ExtTokenTypeMask)


type
  TokenCategory = enum
    PPTokenFlag                 = 0x00040000
    TokenValueMask              = 0x0007FFFF
    AltTokenType                = 0x00080000
    TriGraphTokenType           = 0x00100000
    AltExtTokenType             = 0x00280000
    ExtTokenOnlyMask            = 0x00780000


    IdentifierTokenType         = 0x08040000
    ParameterTokenType          = 0x08840000
    ExtParameterTokenType       = 0x088C0000
    OptParameterTokenType       = 0x08940000
    KeywordTokenType            = 0x10040000
    OperatorTokenType           = 0x18040000
    LiteralTokenType            = 0x20040000
    IntegerLiteralTokenType     = 0x20840000
    FloatingLiteralTokenType    = 0x21040000
    StringLiteralTokenType      = 0x21840000
    CharacterLiteralTokenType   = 0x22040000
    BoolLiteralTokenType        = 0x22840000
    PPTokenType                 = 0x28040000
    PPConditionalTokenType      = 0x28440000

    UnknownTokenType            = 0x50000000
    EOLTokenType                = 0x58000000
    EOFTokenType                = 0x60000000
    WhiteSpaceTokenType         = 0x68000000
    InternalTokenType           = 0x70040000

    TokenTypeMask               = 0x7F800000


    MainTokenMask               = 0x7F87FFFF
    ExtTokenTypeMask            = 0x7FF80000

import std/macros

type
  WaveTokenId* = enum
    T_UNKNOWN = 0
    T_FIRST_TOKEN = 256
    T_IDENTIFIER = 134480252
    T_ASM = 268697905
    T_AUTO = 268697906
    T_BOOL = 268697907
    T_BREAK = 268697910
    T_CASE = 268697911
    T_CATCH = 268697912
    T_CHAR = 268697913
    T_CLASS = 268697914
    T_CONST = 268697915
    T_CONSTCAST = 268697916
    T_CONTINUE = 268697917
    T_DEFAULT = 268697918
    T_DELETE = 268697919
    T_DO = 268697920
    T_DOUBLE = 268697921
    T_DYNAMICCAST = 268697922
    T_ELSE = 268697923
    T_ENUM = 268697924
    T_EXPLICIT = 268697925
    T_EXPORT = 268697926
    T_EXTERN = 268697927
    T_FLOAT = 268697928
    T_FOR = 268697929
    T_FRIEND = 268697930
    T_GOTO = 268697931
    T_IF = 268697932
    T_INLINE = 268697933
    T_INT = 268697934
    T_LONG = 268697935
    T_MUTABLE = 268697936
    T_NAMESPACE = 268697937
    T_NEW = 268697938
    T_OPERATOR = 268697939
    T_PRIVATE = 268697940
    T_PROTECTED = 268697941
    T_PUBLIC = 268697942
    T_REGISTER = 268697943
    T_REINTERPRETCAST = 268697944
    T_RETURN = 268697945
    T_SHORT = 268697946
    T_SIGNED = 268697947
    T_SIZEOF = 268697948
    T_STATIC = 268697949
    T_STATICCAST = 268697950
    T_STRUCT = 268697951
    T_SWITCH = 268697952
    T_TEMPLATE = 268697953
    T_THIS = 268697954
    T_THROW = 268697955
    T_TRY = 268697956
    T_TYPEDEF = 268697957
    T_TYPEID = 268697958
    T_TYPENAME = 268697959
    T_UNION = 268697960
    T_UNSIGNED = 268697961
    T_USING = 268697962
    T_VIRTUAL = 268697963
    T_VOID = 268697964
    T_VOLATILE = 268697965
    T_WCHART = 268697966
    T_WHILE = 268697967
    T_MSEXT_INT8 = 268698004
    T_MSEXT_INT16 = 268698005
    T_MSEXT_INT32 = 268698006
    T_MSEXT_INT64 = 268698007
    T_MSEXT_BASED = 268698008
    T_MSEXT_DECLSPEC = 268698009
    T_MSEXT_CDECL = 268698010
    T_MSEXT_FASTCALL = 268698011
    T_MSEXT_STDCALL = 268698012
    T_MSEXT_TRY = 268698013
    T_MSEXT_EXCEPT = 268698014
    T_MSEXT_FINALLY = 268698015
    T_MSEXT_LEAVE = 268698016
    T_MSEXT_INLINE = 268698017
    T_MSEXT_ASM = 268698018
    T_IMPORT = 268698021
    T_ALIGNAS = 268698022
    T_ALIGNOF = 268698023
    T_CHAR16_T = 268698024
    T_CHAR32_T = 268698025
    T_CONSTEXPR = 268698026
    T_DECLTYPE = 268698027
    T_NOEXCEPT = 268698028
    T_NULLPTR = 268698029
    T_STATICASSERT = 268698030
    T_THREADLOCAL = 268698031
    T_CHAR8_T = 268698033
    T_CONCEPT = 268698034
    T_CONSTEVAL = 268698035
    T_CONSTINIT = 268698036
    T_CO_AWAIT = 268698037
    T_CO_RETURN = 268698038
    T_CO_YIELD = 268698039
    T_REQUIRES = 268698040
    T_AND = 402915584
    T_ANDAND = 402915585
    T_ASSIGN = 402915586
    T_ANDASSIGN = 402915587
    T_OR = 402915588
    T_ORASSIGN = 402915589
    T_XOR = 402915590
    T_XORASSIGN = 402915591
    T_COMMA = 402915592
    T_COLON = 402915593
    T_DIVIDE = 402915594
    T_DIVIDEASSIGN = 402915595
    T_DOT = 402915596
    T_DOTSTAR = 402915597
    T_ELLIPSIS = 402915598
    T_EQUAL = 402915599
    T_GREATER = 402915600
    T_GREATEREQUAL = 402915601
    T_LEFTBRACE = 402915602
    T_LESS = 402915603
    T_LESSEQUAL = 402915604
    T_LEFTPAREN = 402915605
    T_LEFTBRACKET = 402915606
    T_MINUS = 402915607
    T_MINUSASSIGN = 402915608
    T_MINUSMINUS = 402915609
    T_PERCENT = 402915610
    T_PERCENTASSIGN = 402915611
    T_NOT = 402915612
    T_NOTEQUAL = 402915613
    T_OROR = 402915614
    T_PLUS = 402915615
    T_PLUSASSIGN = 402915616
    T_PLUSPLUS = 402915617
    T_ARROW = 402915618
    T_ARROWSTAR = 402915619
    T_QUESTION_MARK = 402915620
    T_RIGHTBRACE = 402915621
    T_RIGHTPAREN = 402915622
    T_RIGHTBRACKET = 402915623
    T_COLON_COLON = 402915624
    T_SEMICOLON = 402915625
    T_SHIFTLEFT = 402915626
    T_SHIFTLEFTASSIGN = 402915627
    T_SHIFTRIGHT = 402915628
    T_SHIFTRIGHTASSIGN = 402915629
    T_STAR = 402915630
    T_COMPL = 402915631
    T_STARASSIGN = 402915632
    T_POUND_POUND = 402915723
    T_POUND = 402915724
    T_SPACESHIP = 402915769
    T_LEFTBRACE_ALT = 403439890
    T_LEFTBRACKET_ALT = 403439894
    T_RIGHTBRACE_ALT = 403439909
    T_RIGHTBRACKET_ALT = 403439911
    T_POUND_POUND_ALT = 403440011
    T_POUND_ALT = 403440012
    T_OR_TRIGRAPH = 403964164
    T_ORASSIGN_TRIGRAPH = 403964165
    T_XOR_TRIGRAPH = 403964166
    T_XORASSIGN_TRIGRAPH = 403964167
    T_LEFTBRACE_TRIGRAPH = 403964178
    T_LEFTBRACKET_TRIGRAPH = 403964182
    T_OROR_TRIGRAPH = 403964190
    T_RIGHTBRACE_TRIGRAPH = 403964197
    T_RIGHTBRACKET_TRIGRAPH = 403964199
    T_COMPL_TRIGRAPH = 403964207
    T_POUND_POUND_TRIGRAPH = 403964299
    T_POUND_TRIGRAPH = 403964300
    T_AND_ALT = 405537024
    T_ANDAND_ALT = 405537025
    T_ANDASSIGN_ALT = 405537027
    T_OR_ALT = 405537028
    T_ORASSIGN_ALT = 405537029
    T_XOR_ALT = 405537030
    T_XORASSIGN_ALT = 405537031
    T_NOT_ALT = 405537052
    T_NOTEQUAL_ALT = 405537053
    T_OROR_ALT = 405537054
    T_COMPL_ALT = 405537071
    T_OCTALINT = 545522045
    T_DECIMALINT = 545522046
    T_HEXAINT = 545522047
    T_INTLIT = 545522048
    T_LONGINTLIT = 545522049
    T_FLOATLIT = 553910658
    T_FIXEDPOINTLIT = 554434946
    T_STRINGLIT = 562299270
    T_RAWSTRINGLIT = 562299312
    T_CHARLIT = 570687877
    T_FALSE = 579076404
    T_TRUE = 579076405
    T_PP_DEFINE = 671351152
    T_PP_ERROR = 671351159
    T_PP_LINE = 671351160
    T_PP_PRAGMA = 671351161
    T_PP_UNDEF = 671351162
    T_PP_WARNING = 671351163
    T_PP_INCLUDE = 671351182
    T_PP_QHEADER = 671351183
    T_PP_HHEADER = 671351184
    T_MSEXT_PP_REGION = 671351203
    T_MSEXT_PP_ENDREGION = 671351204
    T_PP_INCLUDE_NEXT = 671875470
    T_PP_QHEADER_NEXT = 671875471
    T_PP_HHEADER_NEXT = 671875472
    T_PP_IF = 675545457
    T_PP_IFDEF = 675545458
    T_PP_IFNDEF = 675545459
    T_PP_ELSE = 675545460
    T_PP_ELIF = 675545461
    T_PP_ENDIF = 675545462
    T_ANY = 1342177677
    T_ANY_TRIGRAPH = 1343226253
    T_CONTLINE = 1476395399
    T_NEWLINE = 1476395402
    T_GENERATEDNEWLINE = 1476919690
    T_EOF = 1610613137
    T_EOI = 1610613138
    T_SPACE = 1744830856
    T_SPACE2 = 1744830857
    T_CCOMMENT = 1745355139
    T_CPPCOMMENT = 1745355140
    T_PP_NUMBER = 1879310739

    # # T_LAST_TOKEN_ID = 1879310739 + 1

    # T_LAST_TOKEN               = (((1879310739 + 1) and not PPTokenFlag.uint) and not TokenTypeMask.uint)
    # T_UNKNOWN_UNIVERSALCHAR    = (('\\'.int) or (UnknownTokenType))
    # T_NONREPLACABLE_IDENTIFIER = ((T_LAST_TOKEN + 1) or (IdentifierTokenType))
    # T_PLACEHOLDER              = ((T_LAST_TOKEN + 2) or (WhiteSpaceTokenType))
    # T_PLACEMARKER              = ((T_LAST_TOKEN + 3) or (InternalTokenType))
    # T_PARAMETERBASE            = ((T_LAST_TOKEN + 4) or (ParameterTokenType))
    # T_EXTPARAMETERBASE         = ((T_LAST_TOKEN + 4) or (ExtParameterTokenType))
    # T_OPTPARAMETERBASE         = ((T_LAST_TOKEN + 4) or (OptParameterTokenType))
